{"version":3,"sources":["lib/plugins/tick.js"],"names":["module","exports","server","serv","tickCount","lastTickTime","setTickInterval","stopTickInterval","tickInterval","setInterval","t","Date","now","time","emit","ticksPerSecond","clearInterval"],"mappings":";;AAAAA,OAAOC,OAAP,CAAeC,MAAf,GAAsB,UAASC,IAAT,EAAe;AACnCA,OAAKC,SAAL,GAAiB,CAAjB;AACAD,OAAKE,YAAL,GAAoB,CAApB;;AAGAF,OAAKG,eAAL,GAAuB,0BAAkB;AACvCH,SAAKI,gBAAL;;AAEAJ,SAAKK,YAAL,GAAoBC,YAAY,YAAM;AACpCN,WAAKC,SAAL;AACA,UAAMM,IAAEC,KAAKC,GAAL,EAAR;AACA,UAAIC,OAAO,CAACH,IAAIP,KAAKE,YAAV,IAA0B,IAArC;AACA,UAAIQ,OAAO,GAAX,EAAgBA,OAAO,CAAP;AAChBV,WAAKW,IAAL,CAAU,MAAV,EAAkBD,IAAlB,EAAwBV,KAAKC,SAA7B;AACAD,WAAKE,YAAL,GAAoBK,CAApB;AACD,KAPmB,EAOjB,OAAKK,cAPY,CAApB;AAQD,GAXD;;AAaAZ,OAAKI,gBAAL,GAAwB,YAAM;AAC5B,QAAIJ,KAAKK,YAAT,EAAuBQ,cAAcb,KAAKK,YAAnB;AACvBL,SAAKK,YAAL,GAAoB,IAApB;AACD,GAHD;;AAMAL,OAAKG,eAAL,CAAqB,EAArB;AACD,CAzBD","file":"../../../lib/plugins/tick.js","sourcesContent":["module.exports.server=function(serv) {\n  serv.tickCount = 0;\n  serv.lastTickTime = 0;\n\n\n  serv.setTickInterval = ticksPerSecond => {\n    serv.stopTickInterval();\n\n    serv.tickInterval = setInterval(() => {\n      serv.tickCount++;\n      const t=Date.now();\n      let time = (t - serv.lastTickTime) / 1000;\n      if (time > 100) time = 0;\n      serv.emit('tick', time, serv.tickCount);\n      serv.lastTickTime = t;\n    }, 1000/ticksPerSecond);\n  };\n\n  serv.stopTickInterval = () => {\n    if (serv.tickInterval) clearInterval(serv.tickInterval);\n    serv.tickInterval = null;\n  };\n\n\n  serv.setTickInterval(20);\n};\n\n"]}